{% extends "base.html" %}

{% block title %}Your Pets{% endblock %}

{% block content %}
<style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
  
    th, td {
      padding: 12px 15px;
      border: 1px solid #ddd;
      text-align: left;
    }
  
    th {
      background-color: #D2601A;
      color: white;
    }
  
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  
    a.view-btn {
      color: #D2601A;
      font-weight: 600;
      text-decoration: none;
    }
    a.view-btn:hover {
      text-decoration: underline;
    }

  button.delete-btn {
    background-color: #e76f51;
    border: none;
    color: white;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.3s;
  }
  button.delete-btn:hover {
    background-color: #b44e39;
  }
</style>
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div style="margin-top: 20px;">
      {% for category, message in messages %}
        <div 
          style="
            position: relative;
            padding: 12px 40px 12px 20px;
            margin-bottom: 10px;
            border-radius: 5px;
            font-weight: 500;
            color: white;
            background-color: {% if category == 'success' %}#28a745
                             {% elif category == 'danger' %}#dc3545
                             {% elif category == 'warning' %}#ffc107; color: black;
                             {% else %}#17a2b8{% endif %};
          "
          class="flash-message"
        >
          {{ message }}
          <button 
            onclick="this.parentElement.style.display='none';" 
            style="
              position: absolute;
              top: 50%;
              right: 12px;
              transform: translateY(-50%);
              background: transparent;
              border: none;
              color: inherit;
              font-weight: bold;
              font-size: 20px;
              line-height: 1;
              cursor: pointer;
              padding: 0;
              user-select: none;
            "
            aria-label="Close"
          >
            &times;
          </button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<h2 style="color:#D2601A; margin-bottom: 20px;">Your Pets</h2>

{% if pets %}
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Species</th>
      <th>Breed(s)</th>
      <th>Gender</th>
      <th>Age</th>
      <th>Allergies</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for pet in pets %}
    <tr>
      <td>{{ pet.name }}</td>
      <td>{{ pet.type }}</td>
      <td>{{ pet.breed }}</td>
      <td>{{ pet.gender if pet.gender else 'N/A' }}</td>
      <td>{{ pet.age if pet.age else 'N/A' }}</td>
      <td>{{ pet.allergies if pet.allergies else 'N/A' }}</td>
      <td>
        <form action="{{ url_for('delete_pet', pet_id=pet._id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this pet?');">
          <button type="submit" class="delete-btn">Delete</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>You have no pets registered yet.</p>
{% endif %}
{% endblock %}
